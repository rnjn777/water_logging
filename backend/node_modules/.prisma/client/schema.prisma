generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id               Int      @id @default(autoincrement())
  name             String
  email            String   @unique
  password         String
  createdAt        DateTime @default(now())
  role             Role     @default(USER)
  total_reports    Int      @default(0)
  approved_reports Int      @default(0)
  trust_score      Decimal  @default(0) @db.Decimal(5, 2)
  reports          Report[]

  @@index([trust_score(sort: Desc)], map: "idx_user_trust_score")
}

model Report {
  id            Int       @id @default(autoincrement())
  latitude      Float
  longitude     Float
  severity      String
  createdAt     DateTime  @default(now())
  location      String
  rainIntensity String
  image         String?
  user_id       Int?
  is_approved   Boolean   @default(false)
  is_rejected   Boolean   @default(false)
  approved_at   DateTime? @db.Timestamp(6)
  rejected_at   DateTime? @db.Timestamp(6)
  user          User?     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "report_user_fk")

  @@index([user_id], map: "idx_report_user_id")
}

enum Role {
  USER
  ADMIN
}
